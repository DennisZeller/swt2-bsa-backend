language: java

jdk:
- oraclejdk8

sudo: enabled
install: true

git:
  depth: false
  submodules: false

cache:
  directories:
  - '$HOME/.m2/repository' # cache maven dependencies
  - '$HOME/.sonar/cache' # cache sonar dependencies

branches:
  only:
  - master
  - /^release-.*$/

addons:
  # static code analysis dashboard
  sonarcloud:
    # travis ci environment variable with the key of the org (https://sonarcloud.io/account/organizations)
    organization: $SONAR_CLOUD_ORG
    token:
      # travis ci environment variable with the sonar cloud token (https://sonarcloud.io/account/security/)
      secure: $SONAR_CLOUD_KEY

script:
# change to project directory
- cd bogenliga
# the following command line builds the project, runs the tests with coverage and then execute the SonarCloud analysis
- mvn clean org.jacoco:jacoco-maven-plugin:prepare-agent install sonar:sonar
# maven plugin to generate the code coverage report for https://codecov.io
- mvn cobertura:cobertura
# TODO: TEST
- bash <(curl -s https://codecov.io/bash) # uses CODECOV_TOKEN environment variable

after_success:
- bash <(curl -s https://codecov.io/bash) # uses CODECOV_TOKEN environment variable




